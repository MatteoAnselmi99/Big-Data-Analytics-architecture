2025-07-20 23:33:00,583 INFO: Closing down clientserver connection
2025-07-20 23:41:45,875 INFO: Closing down clientserver connection
2025-07-21 12:34:25,292 ERROR: Traceback (most recent call last):
2025-07-21 12:34:25,293 ERROR: File "/home/matteo/PycharmProjects/Tesi/BDA_Scripts/ingestion_area/5_silver_processing.py", line 297, in <module>
2025-07-21 12:34:25,293 ERROR: join_bronze_tables(spark, behaviour, province, trip_summary, silver_path_tlm)
2025-07-21 12:34:25,293 ERROR: File "/home/matteo/PycharmProjects/Tesi/BDA_Scripts/ingestion_area/5_silver_processing.py", line 114, in join_bronze_tables
2025-07-21 12:34:25,293 ERROR: behaviour_df = spark.read.format("delta").load(behaviour)
2025-07-21 12:34:25,293 ERROR: ^
2025-07-21 12:34:25,293 ERROR: ^
2025-07-21 12:34:25,293 ERROR: ^
2025-07-21 12:34:25,293 ERROR: ^
2025-07-21 12:34:25,293 ERROR: ^
2025-07-21 12:34:25,293 ERROR: ^
2025-07-21 12:34:25,293 ERROR: ^
2025-07-21 12:34:25,293 ERROR: ^
2025-07-21 12:34:25,293 ERROR: ^
2025-07-21 12:34:25,293 ERROR: ^
2025-07-21 12:34:25,293 ERROR: ^
2025-07-21 12:34:25,293 ERROR: ^
2025-07-21 12:34:25,293 ERROR: ^
2025-07-21 12:34:25,293 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: File "/home/matteo/PycharmProjects/Tesi/.venv1/lib/python3.12/site-packages/pyspark/sql/readwriter.py", line 311, in load
2025-07-21 12:34:25,294 ERROR: return self._df(self._jreader.load(path))
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,294 ERROR: ^
2025-07-21 12:34:25,295 ERROR: ^
2025-07-21 12:34:25,295 ERROR: ^
2025-07-21 12:34:25,295 ERROR: ^
2025-07-21 12:34:25,295 ERROR: ^
2025-07-21 12:34:25,295 ERROR: ^
2025-07-21 12:34:25,295 ERROR: File "/home/matteo/PycharmProjects/Tesi/.venv1/lib/python3.12/site-packages/py4j/java_gateway.py", line 1362, in __call__
2025-07-21 12:34:25,295 ERROR: return_value = get_return_value(
2025-07-21 12:34:25,295 ERROR: ^
2025-07-21 12:34:25,295 ERROR: ^
2025-07-21 12:34:25,295 ERROR: ^
2025-07-21 12:34:25,295 ERROR: ^
2025-07-21 12:34:25,295 ERROR: ^
2025-07-21 12:34:25,295 ERROR: ^
2025-07-21 12:34:25,295 ERROR: ^
2025-07-21 12:34:25,295 ERROR: ^
2025-07-21 12:34:25,295 ERROR: ^
2025-07-21 12:34:25,295 ERROR: ^
2025-07-21 12:34:25,295 ERROR: ^
2025-07-21 12:34:25,295 ERROR: ^
2025-07-21 12:34:25,295 ERROR: ^
2025-07-21 12:34:25,295 ERROR: ^
2025-07-21 12:34:25,295 ERROR: ^
2025-07-21 12:34:25,295 ERROR: ^
2025-07-21 12:34:25,295 ERROR: ^
2025-07-21 12:34:25,295 ERROR: File "/home/matteo/PycharmProjects/Tesi/.venv1/lib/python3.12/site-packages/pyspark/errors/exceptions/captured.py", line 288, in deco
2025-07-21 12:34:25,295 ERROR: raise converted from None
2025-07-21 12:34:25,295 ERROR: pyspark.errors.exceptions.captured
2025-07-21 12:34:25,295 ERROR: .
2025-07-21 12:34:25,295 ERROR: AnalysisException
2025-07-21 12:34:25,298 ERROR: :
2025-07-21 12:34:25,298 ERROR: [DELTA_TABLE_NOT_FOUND] Delta table `/home/matteo/BDA_project/ingestion_area/current/bronze/telematics/behaviour` doesn't exist.
2025-07-21 12:34:25,298 INFO: Closing down clientserver connection
2025-07-21 12:37:19,314 INFO: Join completato. Righe totali: 532082
2025-07-21 12:37:22,457 INFO: Salvato in Silver: /home/matteo/BDA_project/ingestion_area/current/silver/telematics
2025-07-21 12:37:23,643 INFO: Salvato in Silver: /home/matteo/BDA_project/ingestion_area/current/silver/claims
2025-07-21 12:37:23,870 INFO: Closing down clientserver connection
2025-07-24 21:21:00,895 INFO: Join completato. Righe totali: 251808
2025-07-24 21:21:03,041 INFO: Salvato in Silver: hdfs://localhost:9000/user/dr.who/ingestion_area/current/silver/telematics
2025-07-24 21:21:03,094 ERROR: Traceback (most recent call last):
2025-07-24 21:21:03,094 ERROR: File "/home/matteo/PycharmProjects/Tesi/BDA_Scripts/ingestion_area/5_silver_processing.py", line 289, in <module>
2025-07-24 21:21:03,094 ERROR: process_claims_and_save(spark,claims,silver_path_clm)
2025-07-24 21:21:03,094 ERROR: File "/home/matteo/PycharmProjects/Tesi/BDA_Scripts/ingestion_area/5_silver_processing.py", line 65, in process_claims_and_save
2025-07-24 21:21:03,094 ERROR: regexp_replace(substring(col("incurred"), 1, length(col("incurred")) - 3), "\.", "").cast("float"))
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,094 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: File "/home/matteo/PycharmProjects/Tesi/.venv1/lib/python3.12/site-packages/pyspark/sql/utils.py", line 160, in wrapped
2025-07-24 21:21:03,095 ERROR: return f(*args, **kwargs)
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: ^
2025-07-24 21:21:03,095 ERROR: File "/home/matteo/PycharmProjects/Tesi/.venv1/lib/python3.12/site-packages/pyspark/sql/functions.py", line 6556, in substring
2025-07-24 21:21:03,096 ERROR: return _invoke_function("substring", _to_java_column(str), pos, len)
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: File "/home/matteo/PycharmProjects/Tesi/.venv1/lib/python3.12/site-packages/pyspark/sql/functions.py", line 95, in _invoke_function
2025-07-24 21:21:03,097 ERROR: return Column(jf(*args))
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: File "/home/matteo/PycharmProjects/Tesi/.venv1/lib/python3.12/site-packages/py4j/java_gateway.py", line 1314, in __call__
2025-07-24 21:21:03,097 ERROR: args_command, temp_args = self._build_args(*args)
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: File "/home/matteo/PycharmProjects/Tesi/.venv1/lib/python3.12/site-packages/py4j/java_gateway.py", line 1277, in _build_args
2025-07-24 21:21:03,097 ERROR: (new_args, temp_args) = self._get_args(args)
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,097 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: File "/home/matteo/PycharmProjects/Tesi/.venv1/lib/python3.12/site-packages/py4j/java_gateway.py", line 1264, in _get_args
2025-07-24 21:21:03,098 ERROR: temp_arg = converter.convert(arg, self.gateway_client)
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: ^
2025-07-24 21:21:03,098 ERROR: File "/home/matteo/PycharmProjects/Tesi/.venv1/lib/python3.12/site-packages/py4j/java_collections.py", line 510, in convert
2025-07-24 21:21:03,099 ERROR: for element in object:
2025-07-24 21:21:03,099 ERROR: File "/home/matteo/PycharmProjects/Tesi/.venv1/lib/python3.12/site-packages/pyspark/sql/column.py", line 710, in __iter__
2025-07-24 21:21:03,099 ERROR: raise TypeError("Column is not iterable")
2025-07-24 21:21:03,099 ERROR: TypeError
2025-07-24 21:21:03,099 ERROR: :
2025-07-24 21:21:03,099 ERROR: Column is not iterable
2025-07-24 21:21:03,100 INFO: Closing down clientserver connection
2025-07-24 21:29:28,782 INFO: Salvato in Silver: hdfs://localhost:9000/user/dr.who/ingestion_area/current/silver/claims
2025-07-24 21:29:28,923 INFO: Closing down clientserver connection
2025-07-24 21:34:39,190 ERROR: Traceback (most recent call last):
2025-07-24 21:34:39,191 ERROR: File "/home/matteo/PycharmProjects/Tesi/BDA_Scripts/ingestion_area/5_silver_processing.py", line 294, in <module>
2025-07-24 21:34:39,191 ERROR: process_claims_and_save(spark,claims,silver_path_clm)
2025-07-24 21:34:39,191 ERROR: File "/home/matteo/PycharmProjects/Tesi/BDA_Scripts/ingestion_area/5_silver_processing.py", line 66, in process_claims_and_save
2025-07-24 21:34:39,191 ERROR: substring(
2025-07-24 21:34:39,191 ERROR: File "/home/matteo/PycharmProjects/Tesi/.venv1/lib/python3.12/site-packages/pyspark/sql/utils.py", line 160, in wrapped
2025-07-24 21:34:39,191 ERROR: return f(*args, **kwargs)
2025-07-24 21:34:39,191 ERROR: ^
2025-07-24 21:34:39,191 ERROR: ^
2025-07-24 21:34:39,191 ERROR: ^
2025-07-24 21:34:39,191 ERROR: ^
2025-07-24 21:34:39,191 ERROR: ^
2025-07-24 21:34:39,191 ERROR: ^
2025-07-24 21:34:39,191 ERROR: ^
2025-07-24 21:34:39,191 ERROR: ^
2025-07-24 21:34:39,191 ERROR: ^
2025-07-24 21:34:39,191 ERROR: ^
2025-07-24 21:34:39,191 ERROR: ^
2025-07-24 21:34:39,191 ERROR: ^
2025-07-24 21:34:39,191 ERROR: ^
2025-07-24 21:34:39,191 ERROR: ^
2025-07-24 21:34:39,191 ERROR: ^
2025-07-24 21:34:39,191 ERROR: ^
2025-07-24 21:34:39,191 ERROR: ^
2025-07-24 21:34:39,191 ERROR: ^
2025-07-24 21:34:39,191 ERROR: File "/home/matteo/PycharmProjects/Tesi/.venv1/lib/python3.12/site-packages/pyspark/sql/functions.py", line 6556, in substring
2025-07-24 21:34:39,192 ERROR: return _invoke_function("substring", _to_java_column(str), pos, len)
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: File "/home/matteo/PycharmProjects/Tesi/.venv1/lib/python3.12/site-packages/pyspark/sql/functions.py", line 95, in _invoke_function
2025-07-24 21:34:39,192 ERROR: return Column(jf(*args))
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: File "/home/matteo/PycharmProjects/Tesi/.venv1/lib/python3.12/site-packages/py4j/java_gateway.py", line 1314, in __call__
2025-07-24 21:34:39,192 ERROR: args_command, temp_args = self._build_args(*args)
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,192 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: File "/home/matteo/PycharmProjects/Tesi/.venv1/lib/python3.12/site-packages/py4j/java_gateway.py", line 1277, in _build_args
2025-07-24 21:34:39,193 ERROR: (new_args, temp_args) = self._get_args(args)
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: File "/home/matteo/PycharmProjects/Tesi/.venv1/lib/python3.12/site-packages/py4j/java_gateway.py", line 1264, in _get_args
2025-07-24 21:34:39,193 ERROR: temp_arg = converter.convert(arg, self.gateway_client)
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,193 ERROR: ^
2025-07-24 21:34:39,194 ERROR: ^
2025-07-24 21:34:39,194 ERROR: ^
2025-07-24 21:34:39,194 ERROR: ^
2025-07-24 21:34:39,194 ERROR: ^
2025-07-24 21:34:39,194 ERROR: ^
2025-07-24 21:34:39,194 ERROR: ^
2025-07-24 21:34:39,194 ERROR: ^
2025-07-24 21:34:39,194 ERROR: ^
2025-07-24 21:34:39,194 ERROR: ^
2025-07-24 21:34:39,194 ERROR: ^
2025-07-24 21:34:39,194 ERROR: ^
2025-07-24 21:34:39,194 ERROR: ^
2025-07-24 21:34:39,194 ERROR: ^
2025-07-24 21:34:39,194 ERROR: ^
2025-07-24 21:34:39,194 ERROR: ^
2025-07-24 21:34:39,194 ERROR: ^
2025-07-24 21:34:39,194 ERROR: ^
2025-07-24 21:34:39,194 ERROR: ^
2025-07-24 21:34:39,194 ERROR: ^
2025-07-24 21:34:39,194 ERROR: ^
2025-07-24 21:34:39,194 ERROR: ^
2025-07-24 21:34:39,194 ERROR: File "/home/matteo/PycharmProjects/Tesi/.venv1/lib/python3.12/site-packages/py4j/java_collections.py", line 510, in convert
2025-07-24 21:34:39,194 ERROR: for element in object:
2025-07-24 21:34:39,194 ERROR: File "/home/matteo/PycharmProjects/Tesi/.venv1/lib/python3.12/site-packages/pyspark/sql/column.py", line 710, in __iter__
2025-07-24 21:34:39,194 ERROR: raise TypeError("Column is not iterable")
2025-07-24 21:34:39,194 ERROR: TypeError
2025-07-24 21:34:39,194 ERROR: :
2025-07-24 21:34:39,194 ERROR: Column is not iterable
2025-07-24 21:34:39,194 INFO: Closing down clientserver connection
2025-07-24 21:37:47,153 INFO: Salvato in Silver: hdfs://localhost:9000/user/dr.who/ingestion_area/current/silver/claims
2025-07-24 21:37:47,402 INFO: Closing down clientserver connection
2025-07-24 21:41:24,056 ERROR: Traceback (most recent call last):
2025-07-24 21:41:24,056 ERROR: File "/home/matteo/PycharmProjects/Tesi/BDA_Scripts/ingestion_area/5_silver_processing.py", line 291, in <module>
2025-07-24 21:41:24,056 ERROR: process_claims_and_save(spark,claims,silver_path_clm)
2025-07-24 21:41:24,056 ERROR: File "/home/matteo/PycharmProjects/Tesi/BDA_Scripts/ingestion_area/5_silver_processing.py", line 101, in process_claims_and_save
2025-07-24 21:41:24,056 ERROR: df_final = df.groupBy("contract").sum(*columns_to_sum)
2025-07-24 21:41:24,056 ERROR: ^
2025-07-24 21:41:24,056 ERROR: ^
2025-07-24 21:41:24,056 ERROR: ^
2025-07-24 21:41:24,056 ERROR: ^
2025-07-24 21:41:24,056 ERROR: ^
2025-07-24 21:41:24,056 ERROR: ^
2025-07-24 21:41:24,056 ERROR: ^
2025-07-24 21:41:24,056 ERROR: ^
2025-07-24 21:41:24,056 ERROR: ^
2025-07-24 21:41:24,056 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: ^
2025-07-24 21:41:24,057 ERROR: File "/home/matteo/PycharmProjects/Tesi/.venv1/lib/python3.12/site-packages/pyspark/sql/group.py", line 49, in _api
2025-07-24 21:41:24,057 ERROR: jdf = getattr(self._jgd, name)(_to_seq(self.session._sc, cols))
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: File "/home/matteo/PycharmProjects/Tesi/.venv1/lib/python3.12/site-packages/py4j/java_gateway.py", line 1322, in __call__
2025-07-24 21:41:24,058 ERROR: return_value = get_return_value(
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: ^
2025-07-24 21:41:24,058 ERROR: File "/home/matteo/PycharmProjects/Tesi/.venv1/lib/python3.12/site-packages/pyspark/errors/exceptions/captured.py", line 175, in deco
2025-07-24 21:41:24,058 ERROR: raise converted from None
2025-07-24 21:41:24,058 ERROR: pyspark.errors.exceptions.captured
2025-07-24 21:41:24,058 ERROR: .
2025-07-24 21:41:24,058 ERROR: AnalysisException
2025-07-24 21:41:24,060 ERROR: :
2025-07-24 21:41:24,060 ERROR: "incurred" is not a numeric column. Aggregation function can only be applied on a numeric column.
2025-07-24 21:41:24,060 INFO: Closing down clientserver connection
2025-07-24 21:42:09,677 INFO: Salvato in Silver: hdfs://localhost:9000/user/dr.who/ingestion_area/current/silver/claims
2025-07-24 21:42:09,913 INFO: Closing down clientserver connection
2025-07-24 23:11:06,257 INFO: Join completato. Righe totali: 251808
2025-07-24 23:11:08,391 INFO: Salvato in Silver: hdfs://localhost:9000/user/dr.who/ingestion_area/current/silver/telematics
2025-07-24 23:11:09,196 INFO: Salvato in Silver: hdfs://localhost:9000/user/dr.who/ingestion_area/current/silver/claims
2025-07-24 23:11:09,281 INFO: Closing down clientserver connection
2025-07-29 18:01:54,366 INFO: Join completato. Righe totali: 8140020
2025-07-29 18:03:26,557 INFO: Salvato in Silver: hdfs://localhost:9000/user/dr.who/ingestion_area/current/silver/telematics
2025-07-29 18:03:28,121 INFO: Salvato in Silver: hdfs://localhost:9000/user/dr.who/ingestion_area/current/silver/claims
2025-07-29 18:03:28,641 INFO: Closing down clientserver connection
